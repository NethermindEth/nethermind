// SPDX-FileCopyrightText: 2022 Demerzel Solutions Limited
// SPDX-License-Identifier: LGPL-3.0-only

using System.Collections.Generic;
using System.Reflection.Metadata;

namespace Nethermind.Evm.Precompiles.Bls
{
    /// <summary>
    /// https://eips.ethereum.org/EIPS/eip-2537
    /// </summary>
    internal static class Discount
    {
        public static int For(int k, bool isG2) => k switch
        {
            var x when x >= 128 => isG2 ? _maxDiscountG2 : _maxDiscountG1,
            _ => isG2 ? _discountTable[k].g2 : _discountTable[k].g1
        };

        private const int _maxDiscountG1 = 435;
        private const int _maxDiscountG2 = 696;

        private static readonly (int g1, int g2)[] _discountTable = 
        {
            (0, 0),        // 0
            (1800, 1800),  // 1
            (888, 1776),   // 2
            (955, 1528),   // 3
            (802, 1282),   // 4
            (743, 1188),   // 5
            (821, 1368),   // 6
            (750, 1250),   // 7
            (680, 1133),   // 8
            (657, 1095),   // 9
            (635, 1269),   // 10
            (612, 1224),   // 11
            (591, 1182),   // 12
            (664, 1137),   // 13
            (637, 1274),   // 14
            (611, 1222),   // 15
            (585, 1169),   // 16
            (578, 1155),   // 17
            (571, 1141),   // 18
            (564, 1127),   // 19
            (557, 1113),   // 20
            (628, 1256),   // 21
            (620, 1240),   // 22
            (612, 1224),   // 23
            (604, 1208),   // 24
            (596, 1192),   // 25
            (588, 1176),   // 26
            (578, 1156),   // 27
            (570, 1140),   // 28
            (562, 1124),   // 29
            (693, 1108),   // 30
            (683, 1092),   // 31
            (673, 1076),   // 32
            (670, 1072),   // 33
            (665, 1064),   // 34
            (663, 1060),   // 35
            (658, 1052),   // 36
            (655, 1048),   // 37
            (650, 1040),   // 38
            (648, 1036),   // 39
            (643, 1028),   // 40
            (640, 1024),   // 41
            (635, 1016),   // 42
            (633, 1012),   // 43
            (628, 1004),   // 44
            (625, 1000),   // 45
            (620, 992),    // 46
            (618, 988),    // 47
            (613, 980),    // 48
            (610, 976),    // 49
            (605, 968),    // 50
            (603, 964),    // 51
            (598, 956),    // 52
            (595, 952),    // 53
            (590, 944),    // 54
            (588, 940),    // 55
            (583, 932),    // 56
            (580, 928),    // 57
            (578, 924),    // 58
            (573, 916),    // 59
            (570, 912),    // 60
            (565, 904),    // 61
            (563, 900),    // 62
            (558, 892),    // 63
            (555, 888),    // 64
            (553, 884),    // 65
            (550, 880),    // 66
            (548, 876),    // 67
            (548, 876),    // 68
            (545, 872),    // 69
            (543, 868),    // 70
            (540, 864),    // 71
            (540, 864),    // 72
            (538, 860),    // 73
            (535, 856),    // 74
            (533, 852),    // 75
            (533, 852),    // 76
            (530, 848),    // 77
            (528, 844),    // 78
            (528, 844),    // 79
            (525, 840),    // 80
            (523, 836),    // 81
            (520, 832),    // 82
            (520, 832),    // 83
            (518, 828),    // 84
            (515, 824),    // 85
            (513, 820),    // 86
            (513, 820),    // 87
            (510, 816),    // 88
            (508, 812),    // 89
            (505, 808),    // 90
            (505, 808),    // 91
            (503, 804),    // 92
            (500, 800),    // 93
            (498, 796),    // 94
            (498, 796),    // 95
            (495, 792),    // 96
            (493, 788),    // 97
            (490, 784),    // 98
            (490, 784),    // 99
            (488, 780),    // 100
            (485, 776),    // 101
            (483, 772),    // 102
            (483, 772),    // 103
            (480, 768),    // 104
            (478, 764),    // 105
            (478, 764),    // 106
            (475, 760),    // 107
            (473, 756),    // 108
            (470, 752),    // 109
            (470, 752),    // 110
            (468, 748),    // 111
            (465, 744),    // 112
            (463, 740),    // 113
            (463, 740),    // 114
            (460, 736),    // 115
            (458, 732),    // 116
            (455, 728),    // 117
            (455, 728),    // 118
            (453, 724),    // 119
            (450, 720),    // 120
            (448, 716),    // 121
            (448, 716),    // 122
            (445, 712),    // 123
            (443, 708),    // 124
            (440, 704),    // 125
            (440, 704),    // 126
            (438, 700),    // 127
            (435, 696)     // 128
        };
    }
}
